app = "talktalkrommie-livekit"
primary_region = "iad"

[build]
  image = "livekit/livekit-server:latest"

[experimental]
  entrypoint = ["/livekit-server"]
  cmd = ["--config", "/etc/livekit.yaml"]

[[files]]
  guest_path = "/etc/livekit.yaml"
  local_path = "livekit.yaml"

# Signaling (WebSocket) - this is how the frontend connects
[[services]]
  internal_port = 7880
  protocol = "tcp"
  [[services.ports]]
    port = 443
    handlers = ["tls", "http"]
  [[services.ports]]
    port = 80
    handlers = ["http"]

# RTC TCP fallback - for when UDP fails
[[services]]
  internal_port = 7881
  protocol = "tcp"
  [[services.ports]]
    port = 7881

# RTC UDP - media traffic
[[services]]
  internal_port = 7882
  protocol = "udp"
  [[services.ports]]
    port = 7882